# JPA / Hibernate 用語集（Glossary）

← [トップへ戻る](index.md)

このファイルは、  
JPA / Hibernate 学習中に出てきた用語を  
**短く・正確に・何度も読み返せる形**でまとめた辞書。

---

## Entity（エンティティ）

DBのテーブルに対応するJavaクラス。  
JPAによって永続化（保存・取得・更新・削除）される対象。
→**JPAが管理できるのはEntityだけ**

---

## EntityManager

Entityを操作するための窓口。  
永続化コンテキストを通じて、Entityの状態を管理する。
→**永続化コンテキストを直接操作する唯一の存在**

---

## 永続化コンテキスト（Persistence Context）

Entityを管理するメモリ上の領域。  
同一Entityは同一インスタンスで管理され、変更検知が可能になる。

---

## managed 状態

Entityが永続化コンテキストで管理されている状態。  
**変更検知・LAZYロードが有効。**

---

## detached 状態

永続化コンテキストから外れたEntityの状態。  
変更検知・LAZYロードは動かない。

---

## new 状態

ただのJavaオブジェクト。  
まだ永続化コンテキストにもDBにも存在しない。

---

## removed 状態

削除予定のEntity状態。  
トランザクション終了時にDELETEされる。

---

## トランザクション（Transaction）

一連のDB操作をまとめる処理単位。  
成功すればcommit、失敗すればrollbackされる。

---

## トランザクション境界

トランザクションが開始されてから終了するまでの範囲。  
永続化コンテキストの有効範囲でもある。
**永続化コンテキストの寿命を決める**

---

## @Transactional

Springでトランザクションを管理するためのアノテーション。  
Service層に付与するのが基本。

---

## Dirty Checking（変更検知）

managed状態のEntityの変更を自動で検知し、  
トランザクション終了時にUPDATEを発行する仕組み。

---

## スナップショット

Entity取得時の初期状態。  
変更検知のために永続化コンテキスト内で保持される。

---

## flush

永続化コンテキストの変更内容をDBに反映する処理。  
**トランザクションは終了しない。**

---

## commit

トランザクションを確定させる処理。  
**内部で必ずflushが行われる。**

---

## rollback

トランザクションを取り消す処理。  
DBへの変更はすべて破棄される。

---

## @ManyToOne

多対一の関連を表すアノテーション。  
**外部キーを持つ側で、関連の管理者（オーナー）。**

---

## @OneToMany

一対多の関連を表すアノテーション。  
mappedByを指定し、逆側として使われることが多い。

---

## mappedBy

関連の管理者がどちらかを示す属性。  
値には **相手Entityのフィールド名** を指定する。

---

## 関連のオーナー

外部キーを管理する側のEntity。  
JPAではオーナー側の変更のみがDBに反映される。

---

## @JoinColumn

外部キーのカラム名を指定するアノテーション。  
実務では明示的に指定するのが基本。

---

## fetch（取得戦略）

関連Entityをいつ取得するかを決める設定。

---

## FetchType.LAZY

関連Entityを必要になるまで取得しない。  
N+1問題やLazyInitializationExceptionの原因になりやすい。

---

## FetchType.EAGER

関連Entityを常に即時取得する。  
実務ではパフォーマンス問題を起こしやすいため非推奨。

---

## N+1問題

親Entity取得後、  
子Entity取得のSQLが件数分（N回）発行される問題。
**原因はLAZY ✖ ループ**

---

## JOIN FETCH

JPQLで関連EntityをJOINして一度に取得する方法。  
**N+1問題の基本的な解決策。だが万能ではない**

---

## JPQL

Entityを対象にしたクエリ言語。  
テーブルではなくクラス・フィールドを指定する。
**テーブル名・カラム名は使わない**

---

## LazyInitializationException

永続化コンテキストが無効な状態で  
LAZYロードを行った際に発生する例外。

---

## cascade（カスケード）

Entity操作を関連Entityへ伝播させる設定。  
使いすぎると削除事故の原因になる。

---

## readOnly トランザクション

参照専用のトランザクション設定。  
変更検知を抑制し、パフォーマンス向上と事故防止に有効。

---

## DTO

データ転送用オブジェクト。  
Entityをそのまま返さず、Controller層で使うのが基本。

---

## アンチパターン

JPAでよくある誤った使い方。  
例：EntityをDTO代わりに使う、ControllerでEntity操作する など。

---

## 用語集の使い方メモ

- 「説明できるか怪しい単語」はここを見る
- 分からなくなったら1行追記する
- **育てる前提のファイル**
